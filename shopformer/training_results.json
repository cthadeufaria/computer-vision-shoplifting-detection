{
  "timestamp": "2025-12-22T14:44:30.445297",
  "model": "Shopformer",
  "description": "Transformer-based shoplifting detection using pose sequences",
  "checkpoint_used": "./checkpoints/best_model.pt",
  "test_data": "./data/PoseLift",
  "num_test_samples": 629,
  "training_config": {
    "data_dir": "./data/PoseLift",
    "use_synthetic": false,
    "output_dir": "./checkpoints",
    "seq_len": 12,
    "num_keypoints": 17,
    "num_tokens": 2,
    "hidden_channels": 64,
    "latent_channels": 8,
    "transformer_heads": 2,
    "transformer_layers": 2,
    "dropout": 0.1,
    "stage1_epochs": 10,
    "stage2_epochs": 20,
    "batch_size": 32,
    "lr": 5e-05,
    "device": "auto"
  },
  "training_history": {
    "stage1_gcae": {
      "epochs_completed": 10,
      "final_loss": 0.016732547538188414,
      "loss_history": [
        0.14802471148531612,
        0.05912812559948704,
        0.0444643724215063,
        0.03489837915129293,
        0.02921575175088434,
        0.024959787968697588,
        0.021957408381893546,
        0.019750661052622125,
        0.018083057810519606,
        0.016732547538188414
      ]
    },
    "best_model": {
      "epoch": 3,
      "best_auc": 0.5701033847896899,
      "metrics": {
        "auc_roc": 0.5701033847896899,
        "auc_pr": 0.5360996763350585,
        "accuracy": 0.5643879173290938,
        "precision": 0.5370786516853933,
        "recall": 0.7785016286644951,
        "f1": 0.6356382978723404,
        "threshold": 0.1403069645166397,
        "fpr": [
          0.0,
          0.003105590062111801,
          0.006211180124223602,
          0.006211180124223602,
          0.012422360248447204,
          0.012422360248447204,
          0.015527950310559006,
          0.015527950310559006,
          0.018633540372670808,
          0.018633540372670808,
          0.021739130434782608,
          0.021739130434782608,
          0.027950310559006212,
          0.027950310559006212,
          0.031055900621118012,
          0.031055900621118012,
          0.034161490683229816,
          0.034161490683229816,
          0.043478260869565216,
          0.043478260869565216,
          0.049689440993788817,
          0.049689440993788817,
          0.059006211180124224,
          0.059006211180124224,
          0.06521739130434782,
          0.06521739130434782,
          0.07453416149068323,
          0.07453416149068323,
          0.07763975155279502,
          0.07763975155279502,
          0.08385093167701864,
          0.08385093167701864,
          0.09316770186335403,
          0.09316770186335403,
          0.09937888198757763,
          0.09937888198757763,
          0.10248447204968944,
          0.10248447204968944,
          0.11801242236024845,
          0.11801242236024845,
          0.12111801242236025,
          0.12111801242236025,
          0.12422360248447205,
          0.12422360248447205,
          0.12732919254658384,
          0.12732919254658384,
          0.13043478260869565,
          0.13043478260869565,
          0.13354037267080746,
          0.13354037267080746,
          0.13664596273291926,
          0.13664596273291926,
          0.14596273291925466,
          0.14596273291925466,
          0.14906832298136646,
          0.14906832298136646,
          0.15217391304347827,
          0.15217391304347827,
          0.15527950310559005,
          0.15527950310559005,
          0.15838509316770186,
          0.15838509316770186,
          0.16459627329192547,
          0.16459627329192547,
          0.16770186335403728,
          0.16770186335403728,
          0.17080745341614906,
          0.17080745341614906,
          0.17391304347826086,
          0.17391304347826086,
          0.18633540372670807,
          0.18633540372670807,
          0.18944099378881987,
          0.18944099378881987,
          0.19254658385093168,
          0.19254658385093168,
          0.20186335403726707,
          0.20186335403726707,
          0.20496894409937888,
          0.20496894409937888,
          0.21428571428571427,
          0.21428571428571427,
          0.2204968944099379,
          0.2204968944099379,
          0.2236024844720497,
          0.2236024844720497,
          0.2267080745341615,
          0.2267080745341615,
          0.2329192546583851,
          0.2329192546583851,
          0.2360248447204969,
          0.2360248447204969,
          0.2422360248447205,
          0.2422360248447205,
          0.2484472049689441,
          0.2484472049689441,
          0.2577639751552795,
          0.2577639751552795,
          0.2670807453416149,
          0.2670807453416149,
          0.2701863354037267,
          0.2701863354037267,
          0.2826086956521739,
          0.2826086956521739,
          0.2857142857142857,
          0.2857142857142857,
          0.2919254658385093,
          0.2919254658385093,
          0.2981366459627329,
          0.2981366459627329,
          0.30124223602484473,
          0.30124223602484473,
          0.30745341614906835,
          0.30745341614906835,
          0.3105590062111801,
          0.3105590062111801,
          0.3198757763975155,
          0.3198757763975155,
          0.33540372670807456,
          0.33540372670807456,
          0.3385093167701863,
          0.3385093167701863,
          0.34782608695652173,
          0.34782608695652173,
          0.35093167701863354,
          0.35093167701863354,
          0.36335403726708076,
          0.36335403726708076,
          0.3695652173913043,
          0.3695652173913043,
          0.37267080745341613,
          0.37267080745341613,
          0.37577639751552794,
          0.37577639751552794,
          0.38198757763975155,
          0.38198757763975155,
          0.38509316770186336,
          0.38509316770186336,
          0.38819875776397517,
          0.38819875776397517,
          0.3944099378881988,
          0.3944099378881988,
          0.40062111801242234,
          0.40062111801242234,
          0.40372670807453415,
          0.40372670807453415,
          0.40683229813664595,
          0.40683229813664595,
          0.41304347826086957,
          0.41304347826086957,
          0.4161490683229814,
          0.4161490683229814,
          0.4192546583850932,
          0.4192546583850932,
          0.4254658385093168,
          0.4254658385093168,
          0.43167701863354035,
          0.43167701863354035,
          0.43788819875776397,
          0.43788819875776397,
          0.4440993788819876,
          0.4440993788819876,
          0.453416149068323,
          0.453416149068323,
          0.45652173913043476,
          0.45652173913043476,
          0.468944099378882,
          0.468944099378882,
          0.4751552795031056,
          0.4751552795031056,
          0.4782608695652174,
          0.4782608695652174,
          0.4813664596273292,
          0.4813664596273292,
          0.4937888198757764,
          0.4937888198757764,
          0.5,
          0.5,
          0.5031055900621118,
          0.5031055900621118,
          0.515527950310559,
          0.515527950310559,
          0.5217391304347826,
          0.5217391304347826,
          0.5279503105590062,
          0.5279503105590062,
          0.531055900621118,
          0.531055900621118,
          0.5341614906832298,
          0.5341614906832298,
          0.5403726708074534,
          0.5403726708074534,
          0.5434782608695652,
          0.5434782608695652,
          0.546583850931677,
          0.546583850931677,
          0.5496894409937888,
          0.5496894409937888,
          0.5590062111801242,
          0.5590062111801242,
          0.5652173913043478,
          0.5652173913043478,
          0.5745341614906833,
          0.5745341614906833,
          0.577639751552795,
          0.577639751552795,
          0.5838509316770186,
          0.5838509316770186,
          0.5900621118012422,
          0.5900621118012422,
          0.593167701863354,
          0.593167701863354,
          0.5962732919254659,
          0.5962732919254659,
          0.6118012422360248,
          0.6118012422360248,
          0.6149068322981367,
          0.6149068322981367,
          0.6180124223602484,
          0.6180124223602484,
          0.6304347826086957,
          0.6304347826086957,
          0.6335403726708074,
          0.6335403726708074,
          0.6366459627329193,
          0.6366459627329193,
          0.639751552795031,
          0.639751552795031,
          0.6645962732919255,
          0.6645962732919255,
          0.6863354037267081,
          0.6863354037267081,
          0.6894409937888198,
          0.6894409937888198,
          0.6925465838509317,
          0.6925465838509317,
          0.7018633540372671,
          0.7018633540372671,
          0.7049689440993789,
          0.7049689440993789,
          0.7080745341614907,
          0.7080745341614907,
          0.7453416149068323,
          0.7453416149068323,
          0.7484472049689441,
          0.7484472049689441,
          0.7577639751552795,
          0.7577639751552795,
          0.7639751552795031,
          0.7639751552795031,
          0.7670807453416149,
          0.7670807453416149,
          0.7701863354037267,
          0.7701863354037267,
          0.7732919254658385,
          0.7732919254658385,
          0.7795031055900621,
          0.7795031055900621,
          0.782608695652174,
          0.782608695652174,
          0.7919254658385093,
          0.7919254658385093,
          0.8136645962732919,
          0.8136645962732919,
          0.8260869565217391,
          0.8260869565217391,
          0.8354037267080745,
          0.8354037267080745,
          0.8385093167701864,
          0.8385093167701864,
          0.8478260869565217,
          0.8478260869565217,
          0.8509316770186336,
          0.8509316770186336,
          0.8540372670807453,
          0.8540372670807453,
          0.8571428571428571,
          0.8571428571428571,
          0.8633540372670807,
          0.8633540372670807,
          0.8664596273291926,
          0.8664596273291926,
          0.8788819875776398,
          0.8788819875776398,
          0.8881987577639752,
          0.8881987577639752,
          0.8944099378881988,
          0.8944099378881988,
          0.9099378881987578,
          0.9099378881987578,
          0.9161490683229814,
          0.9161490683229814,
          0.9316770186335404,
          0.9316770186335404,
          0.9347826086956522,
          0.9347826086956522,
          0.937888198757764,
          0.937888198757764,
          0.9409937888198758,
          0.9409937888198758,
          0.9472049689440993,
          0.9472049689440993,
          0.9596273291925466,
          0.9596273291925466,
          0.9627329192546584,
          0.9627329192546584,
          0.9658385093167702,
          0.9658385093167702,
          0.9813664596273292,
          0.9813664596273292,
          0.984472049689441,
          0.984472049689441,
          0.9968944099378882,
          0.9968944099378882,
          1.0,
          1.0
        ],
        "tpr": [
          0.0,
          0.0,
          0.0,
          0.003257328990228013,
          0.003257328990228013,
          0.006514657980456026,
          0.006514657980456026,
          0.016286644951140065,
          0.016286644951140065,
          0.03257328990228013,
          0.03257328990228013,
          0.03908794788273615,
          0.03908794788273615,
          0.04560260586319218,
          0.04560260586319218,
          0.048859934853420196,
          0.048859934853420196,
          0.05211726384364821,
          0.05211726384364821,
          0.05537459283387622,
          0.05537459283387622,
          0.06188925081433225,
          0.06188925081433225,
          0.06840390879478828,
          0.06840390879478828,
          0.07166123778501629,
          0.07166123778501629,
          0.09120521172638436,
          0.09120521172638436,
          0.10097719869706841,
          0.10097719869706841,
          0.12052117263843648,
          0.12052117263843648,
          0.1237785016286645,
          0.1237785016286645,
          0.1270358306188925,
          0.1270358306188925,
          0.13680781758957655,
          0.13680781758957655,
          0.14006514657980457,
          0.14006514657980457,
          0.1465798045602606,
          0.1465798045602606,
          0.1563517915309446,
          0.1563517915309446,
          0.16612377850162866,
          0.16612377850162866,
          0.18241042345276873,
          0.18241042345276873,
          0.18566775244299674,
          0.18566775244299674,
          0.18892508143322476,
          0.18892508143322476,
          0.19218241042345277,
          0.19218241042345277,
          0.19543973941368079,
          0.19543973941368079,
          0.20846905537459284,
          0.20846905537459284,
          0.21498371335504887,
          0.21498371335504887,
          0.22149837133550487,
          0.22149837133550487,
          0.2247557003257329,
          0.2247557003257329,
          0.23127035830618892,
          0.23127035830618892,
          0.24104234527687296,
          0.24104234527687296,
          0.247557003257329,
          0.247557003257329,
          0.250814332247557,
          0.250814332247557,
          0.2671009771986971,
          0.2671009771986971,
          0.2768729641693811,
          0.2768729641693811,
          0.28013029315960913,
          0.28013029315960913,
          0.28338762214983715,
          0.28338762214983715,
          0.2899022801302932,
          0.2899022801302932,
          0.2931596091205212,
          0.2931596091205212,
          0.2996742671009772,
          0.2996742671009772,
          0.30293159609120524,
          0.30293159609120524,
          0.30618892508143325,
          0.30618892508143325,
          0.30944625407166126,
          0.30944625407166126,
          0.31921824104234525,
          0.31921824104234525,
          0.3289902280130293,
          0.3289902280130293,
          0.34201954397394135,
          0.34201954397394135,
          0.34527687296416937,
          0.34527687296416937,
          0.3583061889250814,
          0.3583061889250814,
          0.3713355048859935,
          0.3713355048859935,
          0.3811074918566775,
          0.3811074918566775,
          0.38436482084690554,
          0.38436482084690554,
          0.38762214983713356,
          0.38762214983713356,
          0.39087947882736157,
          0.39087947882736157,
          0.3941368078175896,
          0.3941368078175896,
          0.3973941368078176,
          0.3973941368078176,
          0.41368078175895767,
          0.41368078175895767,
          0.4201954397394137,
          0.4201954397394137,
          0.42671009771986973,
          0.42671009771986973,
          0.42996742671009774,
          0.42996742671009774,
          0.43322475570032576,
          0.43322475570032576,
          0.4364820846905538,
          0.4364820846905538,
          0.43973941368078173,
          0.43973941368078173,
          0.44299674267100975,
          0.44299674267100975,
          0.4495114006514658,
          0.4495114006514658,
          0.46254071661237783,
          0.46254071661237783,
          0.46579804560260585,
          0.46579804560260585,
          0.48859934853420195,
          0.48859934853420195,
          0.49185667752442996,
          0.49185667752442996,
          0.498371335504886,
          0.498371335504886,
          0.501628664495114,
          0.501628664495114,
          0.50814332247557,
          0.50814332247557,
          0.5179153094462541,
          0.5179153094462541,
          0.5407166123778502,
          0.5407166123778502,
          0.5472312703583062,
          0.5472312703583062,
          0.5504885993485342,
          0.5504885993485342,
          0.5570032573289903,
          0.5570032573289903,
          0.5667752442996743,
          0.5667752442996743,
          0.5700325732899023,
          0.5700325732899023,
          0.5765472312703583,
          0.5765472312703583,
          0.5830618892508144,
          0.5830618892508144,
          0.5895765472312704,
          0.5895765472312704,
          0.5960912052117264,
          0.5960912052117264,
          0.5993485342019544,
          0.5993485342019544,
          0.6026058631921825,
          0.6026058631921825,
          0.6058631921824105,
          0.6058631921824105,
          0.6123778501628665,
          0.6123778501628665,
          0.6188925081433225,
          0.6188925081433225,
          0.6254071661237784,
          0.6254071661237784,
          0.6286644951140065,
          0.6286644951140065,
          0.6319218241042345,
          0.6319218241042345,
          0.6449511400651465,
          0.6449511400651465,
          0.6482084690553745,
          0.6482084690553745,
          0.6579804560260586,
          0.6579804560260586,
          0.6677524429967426,
          0.6677524429967426,
          0.6710097719869706,
          0.6710097719869706,
          0.6872964169381107,
          0.6872964169381107,
          0.6905537459283387,
          0.6905537459283387,
          0.6938110749185668,
          0.6938110749185668,
          0.7003257328990228,
          0.7003257328990228,
          0.7035830618892508,
          0.7035830618892508,
          0.7100977198697068,
          0.7100977198697068,
          0.7166123778501629,
          0.7166123778501629,
          0.7198697068403909,
          0.7198697068403909,
          0.7231270358306189,
          0.7231270358306189,
          0.7263843648208469,
          0.7263843648208469,
          0.739413680781759,
          0.739413680781759,
          0.749185667752443,
          0.749185667752443,
          0.755700325732899,
          0.755700325732899,
          0.758957654723127,
          0.758957654723127,
          0.7719869706840391,
          0.7719869706840391,
          0.7785016286644951,
          0.7785016286644951,
          0.7850162866449512,
          0.7850162866449512,
          0.7882736156351792,
          0.7882736156351792,
          0.7915309446254072,
          0.7915309446254072,
          0.7947882736156352,
          0.7947882736156352,
          0.7980456026058632,
          0.7980456026058632,
          0.8013029315960912,
          0.8013029315960912,
          0.8045602605863192,
          0.8045602605863192,
          0.8273615635179153,
          0.8273615635179153,
          0.8306188925081434,
          0.8306188925081434,
          0.8338762214983714,
          0.8338762214983714,
          0.8403908794788274,
          0.8403908794788274,
          0.8436482084690554,
          0.8436482084690554,
          0.8469055374592834,
          0.8469055374592834,
          0.8501628664495114,
          0.8501628664495114,
          0.8534201954397395,
          0.8534201954397395,
          0.8566775244299675,
          0.8566775244299675,
          0.8599348534201955,
          0.8599348534201955,
          0.8631921824104235,
          0.8631921824104235,
          0.8697068403908795,
          0.8697068403908795,
          0.8729641693811075,
          0.8729641693811075,
          0.8762214983713354,
          0.8762214983713354,
          0.8794788273615635,
          0.8794788273615635,
          0.8827361563517915,
          0.8827361563517915,
          0.8859934853420195,
          0.8859934853420195,
          0.8925081433224755,
          0.8925081433224755,
          0.9087947882736156,
          0.9087947882736156,
          0.9120521172638436,
          0.9120521172638436,
          0.9185667752442996,
          0.9185667752442996,
          0.9283387622149837,
          0.9283387622149837,
          0.9348534201954397,
          0.9348534201954397,
          0.9381107491856677,
          0.9381107491856677,
          0.9413680781758957,
          0.9413680781758957,
          0.9446254071661238,
          0.9446254071661238,
          0.9478827361563518,
          0.9478827361563518,
          0.9511400651465798,
          0.9511400651465798,
          0.9576547231270358,
          0.9576547231270358,
          0.9641693811074918,
          0.9641693811074918,
          0.9706840390879479,
          0.9706840390879479,
          0.9771986970684039,
          0.9771986970684039,
          0.9804560260586319,
          0.9804560260586319,
          0.9869706840390879,
          0.9869706840390879,
          0.990228013029316,
          0.990228013029316,
          0.996742671009772,
          0.996742671009772,
          1.0
        ]
      }
    },
    "stage2_transformer": {
      "epochs_completed": 20,
      "loss_history": []
    }
  },
  "test_metrics": {
    "auc_roc": 0.5701033847896899,
    "auc_pr": 0.5360996763350585,
    "accuracy": 0.5643879173290938,
    "precision": 0.5370786516853933,
    "recall": 0.7785016286644951,
    "f1": 0.6356382978723404,
    "optimal_threshold": 0.1403069943189621
  },
  "score_statistics": {
    "mean": 0.41036826372146606,
    "std": 0.49857139587402344,
    "min": 0.06552906334400177,
    "max": 4.6417317390441895,
    "median": 0.2319650650024414
  }
}